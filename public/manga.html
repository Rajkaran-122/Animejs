<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Manga Writing Hub</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&family=Roboto&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #00bcd4;
      --accent: #ff4081;
      --bg: #181a1b;
      --panel: #23272a;
      --text: #fff;
      --muted: #b0b0b0;
      --radius: 14px;
      --shadow: 0 4px 24px rgba(0,0,0,0.25);
      --transition: 0.3s cubic-bezier(.4,2,.6,1);
    }
    body.light {
      --bg: #f5f7fa;
      --panel: #fff;
      --text: #23272a;
      --muted: #6a6a6a;
      --shadow: 0 4px 24px rgba(0,0,0,0.08);
    }
    html, body {
      margin: 0;
      padding: 0;
      background: var(--bg);
      color: var(--text);
      font-family: 'Roboto', Arial, sans-serif;
      min-height: 100vh;
      scroll-behavior: smooth;
      transition: background 0.4s, color 0.4s;
    }
    body {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }
    header.main-header {
      background: linear-gradient(90deg, var(--primary) 0%, var(--accent) 100%);
      color: #fff;
      padding: 40px 0 20px 0;
      text-align: center;
      box-shadow: var(--shadow);
      border-radius: 0 0 var(--radius) var(--radius);
      animation: fadeInDown 1s;
      position: relative;
    }
    .theme-toggle {
      position: absolute;
      top: 24px;
      right: 32px;
      background: none;
      border: none;
      cursor: pointer;
      outline: none;
      z-index: 10;
      width: 44px;
      height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.2s;
    }
    .theme-toggle:active {
      background: rgba(0,0,0,0.07);
      border-radius: 50%;
    }
    .theme-icon {
      width: 32px;
      height: 32px;
      transition: transform 0.5s cubic-bezier(.4,2,.6,1);
      display: block;
    }
    .theme-icon .sun {
      opacity: 1;
      transition: opacity 0.4s;
      fill: #FFD600;
    }
    .theme-icon .moon {
      opacity: 0;
      transition: opacity 0.4s;
      fill: #23272a;
    }
    body.light .theme-icon .sun {
      opacity: 0;
    }
    body.light .theme-icon .moon {
      opacity: 1;
    }
    header h1 {
      font-family: 'Montserrat', sans-serif;
      font-size: 2.8rem;
      margin: 0 0 10px 0;
      letter-spacing: 2px;
      text-shadow: 0 2px 8px rgba(0,0,0,0.2);
    }
    header p {
      font-size: 1.2rem;
      color: #e0e0e0;
      margin: 0;
    }
    .container {
      max-width: 1100px;
      margin: 30px auto 0 auto;
      padding: 0 20px 40px 20px;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 32px;
      animation: fadeInUp 1.2s;
    }
    @media (max-width: 900px) {
      .container { grid-template-columns: 1fr; }
    }
    section, .editor-container, .upload-container, .feed-container, .form-box {
      background: var(--panel);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 28px 24px;
      margin-bottom: 18px;
      animation: fadeIn 1.2s;
      transition: background 0.4s, color 0.4s, box-shadow 0.4s;
    }
    h2 {
      font-family: 'Montserrat', sans-serif;
      color: var(--primary);
      margin-top: 0;
      margin-bottom: 18px;
      font-size: 1.5rem;
      letter-spacing: 1px;
    }
    ul {
      padding-left: 20px;
    }
    li {
      margin-bottom: 8px;
      color: var(--muted);
    }
    .input-field, .textarea-field {
      width: 100%;
      padding: 12px;
      margin-bottom: 12px;
      border-radius: 8px;
      border: 1.5px solid #333;
      background: #222;
      color: #fff;
      font-size: 1rem;
      transition: border-color var(--transition), background 0.4s, color 0.4s;
    }
    body.light .input-field, body.light .textarea-field {
      background: #f5f7fa;
      color: #23272a;
      border: 1.5px solid #bbb;
    }
    .input-field:focus, .textarea-field:focus {
      border-color: var(--primary);
      outline: none;
      box-shadow: 0 0 8px var(--primary);
    }
    .character-count {
      text-align: right;
      color: var(--muted);
      font-size: 0.95em;
      margin-bottom: 10px;
      transition: color 0.2s;
    }
    .character-count.over {
      color: var(--accent);
      font-weight: bold;
    }
    .btn-primary, .btn {
      background: linear-gradient(90deg, var(--primary), var(--accent));
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 12px 24px;
      font-size: 1.1rem;
      font-family: 'Montserrat', sans-serif;
      cursor: pointer;
      margin-top: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.15);
      transition: transform 0.15s, box-shadow 0.15s, background 0.3s;
    }
    .btn-primary:hover, .btn:hover {
      transform: translateY(-2px) scale(1.04);
      box-shadow: 0 6px 24px rgba(0,0,0,0.25);
      background: linear-gradient(90deg, var(--accent), var(--primary));
    }
    .editor-container {
      margin-top: 0;
    }
    .editor {
      min-height: 120px;
      border: 1.5px solid #444;
      border-radius: 8px;
      background: #181a1b;
      color: #fff;
      font-size: 1rem;
      padding: 12px;
      margin-bottom: 10px;
      transition: border-color var(--transition), background 0.4s, color 0.4s;
    }
    body.light .editor {
      background: #f5f7fa;
      color: #23272a;
      border: 1.5px solid #bbb;
    }
    .editor:focus {
      border-color: var(--primary);
      outline: none;
    }
    .upload-container {
      text-align: center;
    }
    #cover-upload {
      margin-top: 10px;
      color: #fff;
    }
    body.light #cover-upload {
      color: #23272a;
    }
    #cover-preview img {
      max-width: 180px;
      margin-top: 16px;
      border-radius: var(--radius);
      box-shadow: 0 2px 12px rgba(0,0,0,0.18);
      animation: fadeIn 0.8s;
    }
    .feed-container {
      margin-top: 0;
    }
    #feed .story {
      margin-bottom: 18px;
      padding: 14px 18px;
      background: #23272a;
      border-radius: 8px;
      box-shadow: 0 1px 6px rgba(0,0,0,0.08);
      animation: fadeInUp 0.7s;
      transition: box-shadow 0.2s, background 0.4s;
    }
    body.light #feed .story {
      background: #f5f7fa;
      box-shadow: 0 1px 6px rgba(0,0,0,0.04);
    }
    #feed .story:hover {
      box-shadow: 0 4px 18px var(--primary);
      background: #1f2326;
    }
    body.light #feed .story:hover {
      background: #e0e0e0;
    }
    #feed .story h3 {
      margin-bottom: 6px;
      color: var(--accent);
      font-size: 1.1rem;
    }
    #feed .story p {
      color: #e0e0e0;
      margin: 0;
    }
    body.light #feed .story p {
      color: #23272a;
    }
    .form-box {
      max-width: 350px;
      margin: 0 auto;
      background: #1e1e1e;
      border: 2px solid var(--primary);
      box-shadow: var(--shadow);
      text-align: center;
      animation: fadeIn 1.2s;
      transition: background 0.4s, color 0.4s, border 0.4s;
    }
    body.light .form-box {
      background: #fff;
      color: #23272a;
      border: 2px solid var(--primary);
    }
    .form-link {
      margin-top: 10px;
      color: var(--muted);
      font-size: 14px;
    }
    .form-link a {
      color: var(--primary);
      text-decoration: none;
      transition: text-decoration 0.2s;
    }
    .form-link a:hover {
      text-decoration: underline;
    }
    .manga-posts {
      grid-column: 1 / -1;
      margin-top: 0;
      background: var(--panel);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 28px 24px;
      animation: fadeIn 1.2s;
      transition: background 0.4s, color 0.4s, box-shadow 0.4s;
    }
    body.light .manga-posts {
      background: #fff;
      color: #23272a;
      box-shadow: 0 4px 24px rgba(0,0,0,0.08);
    }
    .manga-posts .no-posts {
      color: var(--muted);
      font-style: italic;
      margin-top: 8px;
    }
    .manga-posts .post {
      background: #23272a;
      border-radius: 8px;
      margin-bottom: 14px;
      padding: 14px 18px;
      box-shadow: 0 1px 6px rgba(0,0,0,0.08);
      animation: fadeInUp 0.7s;
      transition: background 0.4s, color 0.4s, box-shadow 0.4s;
    }
    body.light .manga-posts .post {
      background: #f5f7fa;
      color: #23272a;
      box-shadow: 0 1px 6px rgba(0,0,0,0.04);
    }
    .manga-posts .post h3 {
      color: var(--primary);
      margin-bottom: 4px;
    }
    .manga-posts .post p {
      color: #e0e0e0;
      margin: 0;
    }
    body.light .manga-posts .post p {
      color: #23272a;
    }
    footer {
      background: #181a1b;
      color: #b0b0b0;
      text-align: center;
      padding: 18px 0;
      font-size: 1rem;
      border-radius: var(--radius) var(--radius) 0 0;
      margin-top: auto;
      box-shadow: 0 -2px 12px rgba(0,0,0,0.12);
      transition: background 0.4s, color 0.4s;
    }
    body.light footer {
      background: #f5f7fa;
      color: #6a6a6a;
      box-shadow: 0 -2px 12px rgba(0,0,0,0.04);
    }
    /* Animations */
    @keyframes fadeIn {
      from { opacity: 0; transform: scale(0.98);}
      to { opacity: 1; transform: scale(1);}
    }
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(30px);}
      to { opacity: 1; transform: translateY(0);}
    }
    @keyframes fadeInDown {
      from { opacity: 0; transform: translateY(-30px);}
      to { opacity: 1; transform: translateY(0);}
    }
    /* Responsive */
    @media (max-width: 600px) {
      .container, .manga-posts { padding: 10px; }
      section, .editor-container, .upload-container, .feed-container, .form-box, .manga-posts { padding: 14px 8px; }
      header.main-header { padding: 24px 0 10px 0; }
      .theme-toggle { top: 10px; right: 10px; }
    }
  </style>
</head>
<body>
  <header class="main-header">
    <button class="theme-toggle" id="themeToggle" aria-label="Toggle dark/light mode">
      <svg class="theme-icon" viewBox="0 0 32 32">
        <g class="sun">
          <circle cx="16" cy="16" r="8"/>
          <g>
            <line x1="16" y1="2" x2="16" y2="7" stroke="#FFD600" stroke-width="2" stroke-linecap="round"/>
            <line x1="16" y1="25" x2="16" y2="30" stroke="#FFD600" stroke-width="2" stroke-linecap="round"/>
            <line x1="2" y1="16" x2="7" y2="16" stroke="#FFD600" stroke-width="2" stroke-linecap="round"/>
            <line x1="25" y1="16" x2="30" y2="16" stroke="#FFD600" stroke-width="2" stroke-linecap="round"/>
            <line x1="6.2" y1="6.2" x2="9.8" y2="9.8" stroke="#FFD600" stroke-width="2" stroke-linecap="round"/>
            <line x1="22.2" y1="22.2" x2="25.8" y2="25.8" stroke="#FFD600" stroke-width="2" stroke-linecap="round"/>
            <line x1="6.2" y1="25.8" x2="9.8" y2="22.2" stroke="#FFD600" stroke-width="2" stroke-linecap="round"/>
            <line x1="22.2" y1="9.8" x2="25.8" y2="6.2" stroke="#FFD600" stroke-width="2" stroke-linecap="round"/>
          </g>
        </g>
        <g class="moon">
          <path d="M22 16A8 8 0 0 1 12 8a8 8 0 1 0 10 8z"/>
        </g>
      </svg>
    </button>
    <h1>Manga Writing Hub</h1>
    <p>Write and share your amazing Manga stories with the world!</p>
  </header>
     
  <section>
    <section class="guide manga-guide-animated">
  <!-- Animated Decorative Manga BG -->
  <svg id="mangaBg" style="position:absolute;right:-60px;top:-40px;opacity:0.10;z-index:0;pointer-events:none;" width="220" height="220" viewBox="0 0 220 220">
    <ellipse id="bg1" cx="110" cy="110" rx="100" ry="60" fill="#00bcd4"/>
    <ellipse id="bg2" cx="110" cy="110" rx="60" ry="100" fill="#ff4081"/>
    <ellipse id="bg3" cx="110" cy="110" rx="80" ry="80" fill="#fff"/>
  </svg>
  <div class="guide-content">
    <h2 class="fadeInDown">How to Write Manga</h2>
    <blockquote class="fadeIn" style="font-style:italic;color:var(--accent);margin:0 0 16px 0;border-top:4px solid var(--primary);padding-top:8px;">
      “A story is only as strong as its characters and the world they live in.”
    </blockquote>
    <p class="fadeIn">Follow these steps to craft a compelling Manga:</p>
    <ul class="fadeInUp guide-list">
      <li><strong>Develop Your Storyline:</strong> Start with a unique and captivating plot.</li>
      <li><strong>Create Relatable Characters:</strong> Ensure characters are dynamic and relatable.</li>
      <li><strong>Plan Your Panels:</strong> Sketch out the flow of your story visually.</li>
      <li><strong>Write Effective Dialogue:</strong> Keep it natural and impactful.</li>
      <li><strong>Edit and Polish:</strong> Review your work for clarity and consistency.</li>
    </ul>

    <!-- Pro Tips Collapsible -->
    <div style="margin:18px 0;">
      <button id="proTipsBtn" class="pro-tips-btn">
        <span id="proTipsIcon" class="pro-tips-icon">&#9654;</span> Pro Tips
      </button>
      <div id="proTipsPanel" class="pro-tips-panel">
        <ul>
          <li><strong>Show, don’t tell:</strong> Use visuals and actions to express emotions.</li>
          <li><strong>Read a lot:</strong> Study your favorite manga for inspiration and pacing.</li>
          <li><strong>Keep a sketchbook:</strong> Jot down ideas, doodles, and panel layouts anytime.</li>
          <li><strong>Collaborate:</strong> Get feedback from friends or online communities.</li>
        </ul>
      </div>
    </div>

    <!-- Recommended Tools -->
    <div style="margin:18px 0 0 0;">
      <div style="font-weight:bold;margin-bottom:6px;">Recommended Tools:</div>
      <ul class="tools-list">
        <li class="tool-anim">
          <svg width="20" height="20" fill="none"><circle cx="10" cy="10" r="9" stroke="#00bcd4" stroke-width="2"/><rect x="7" y="7" width="6" height="6" fill="#00bcd4"/></svg>
          <span>Clip Studio Paint</span>
        </li>
        <li class="tool-anim">
          <svg width="20" height="20" fill="none"><rect x="2" y="2" width="16" height="16" rx="4" stroke="#ff4081" stroke-width="2"/><circle cx="10" cy="10" r="4" fill="#ff4081"/></svg>
          <span>MediBang</span>
        </li>
        <li class="tool-anim">
          <svg width="20" height="20" fill="none"><ellipse cx="10" cy="10" rx="8" ry="6" stroke="#FFD600" stroke-width="2"/><ellipse cx="10" cy="10" rx="3" ry="2" fill="#FFD600"/></svg>
          <span>Procreate</span>
        </li>
      </ul>
    </div>

    <!-- Did You Know? -->
    <div class="manga-fact" id="mangaFact"></div>

    <!-- Start Now Button -->
    <div style="margin-top:24px;">
      <button id="startNowBtn" class="start-btn">
        Start Your Manga &rarr;
      </button>
    </div>
  </div>
  <style>
    .manga-guide-animated {
      position:relative;
      overflow:hidden;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      text-align:center;
      min-height:520px;
      /* Animated border */
      border-radius: 22px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.18);
      border: 4px solid;
      border-image: linear-gradient(120deg, var(--primary), var(--accent), #FFD600, var(--primary)) 1;
      animation: borderShine 3s linear infinite;
      margin-bottom: 32px;
      z-index: 1;
    }
    @keyframes borderShine {
      0% { border-image-source: linear-gradient(120deg, var(--primary), var(--accent), #FFD600, var(--primary)); }
      50% { border-image-source: linear-gradient(300deg, #FFD600, var(--primary), var(--accent), #FFD600); }
      100% { border-image-source: linear-gradient(120deg, var(--primary), var(--accent), #FFD600, var(--primary)); }
    }
    .guide-content {
      position:relative;
      z-index:1;
      max-width:540px;
      width:100%;
      margin:0 auto;
      border-radius: 16px;
      padding: 32px 18px 24px 18px;
      box-shadow: 0 2px 16px rgba(0,0,0,0.10);
      backdrop-filter: blur(2px);
    }
    .guide-content h2 { margin-bottom: 10px; }
    .guide-list {
      list-style:none;
      padding:0;
      margin:0 0 18px 0;
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:8px;
    }
    .tools-list {
      display:flex;
      gap:18px;
      list-style:none;
      padding:0;
      margin:0;
      justify-content:center;
      flex-wrap:wrap;
    }
    .tool-anim {
      display:flex;
      align-items:center;
      gap:6px;
      cursor:pointer;
      transition:transform 0.3s, background 0.3s, box-shadow 0.3s;
      padding: 4px 10px;
      border-radius: 6px;
    }
    .tool-anim:hover {
      transform: scale(1.15) rotate(-3deg);
      background: rgba(0,188,212,0.10);
      box-shadow: 0 2px 12px rgba(0,188,212,0.10);
    }
    .pro-tips-btn {
      background:var(--primary);
      color:#fff;
      border:none;
      padding:8px 18px;
      border-radius:8px;
      cursor:pointer;
      font-family:'Montserrat',sans-serif;
      font-size:1rem;
      transition:background 0.2s;
      display:inline-flex;
      align-items:center;
      gap:8px;
      box-shadow:0 2px 8px rgba(0,0,0,0.10);
      outline: none;
      position:relative;
      z-index:2;
    }
    .pro-tips-btn:active { background: var(--accent);}
    .pro-tips-icon {
      display:inline-block;
      transition:transform 0.5s cubic-bezier(.4,2,.6,1);
      font-size:1.2em;
    }
    .pro-tips-panel {
      max-height:0;
      overflow:hidden;
      transition:max-height 0.6s cubic-bezier(.4,2,.6,1), padding 0.4s;
      background:rgba(0,188,212,0.10);
      border-radius:8px;
      margin-top:8px;
      padding:0 12px;
      text-align:left;
      box-shadow: 0 2px 8px rgba(0,0,0,0.04);
    }
    .pro-tips-panel ul { margin:12px 0 0 0; list-style:none; padding:0;}
    .start-btn {
      background:linear-gradient(90deg,var(--primary),var(--accent));
      color:#fff;
      border:none;
      padding:12px 28px;
      border-radius:8px;
      font-size:1.1rem;
      font-family:'Montserrat',sans-serif;
      cursor:pointer;
      box-shadow:0 2px 8px rgba(0,0,0,0.12);
      transition:background 0.2s, transform 0.2s;
      animation:pulseBtn 1.8s infinite;
      outline: none;
    }
    .start-btn:active { background:linear-gradient(90deg,var(--accent),var(--primary)); }
    @keyframes fadeInDown { from { opacity:0; transform:translateY(-30px);} to { opacity:1; transform:translateY(0);} }
    @keyframes fadeIn { from { opacity:0;} to { opacity:1;} }
    @keyframes fadeInUp { from { opacity:0; transform:translateY(30px);} to { opacity:1; transform:translateY(0);} }
    @keyframes pulseBtn {
      0% { box-shadow:0 0 0 0 rgba(0,188,212,0.18);}
      70% { box-shadow:0 0 0 10px rgba(0,188,212,0);}
      100% { box-shadow:0 0 0 0 rgba(0,188,212,0.18);}
    }
    .fadeInDown { animation: fadeInDown 1s; }
    .fadeIn { animation: fadeIn 1.2s; }
    .fadeInUp { animation: fadeInUp 1.4s; }
    .manga-fact {
      margin: 22px 0 0 0;
      font-size: 1.05em;
      color: var(--primary);
      background: rgba(0,188,212,0.07);
      border-radius: 8px;
      padding: 10px 16px;
      min-height: 32px;
      font-style: italic;
      box-shadow: 0 1px 6px rgba(0,0,0,0.04);
      transition: background 0.3s, color 0.3s;
      animation: fadeIn 1.5s;
      display: inline-block;
    }
    @media (max-width: 700px) {
      .guide-content { max-width: 98vw; }
      .tools-list { flex-direction:column; align-items:center; }
    }
  </style>
  <script>
    // Pro Tips Collapsible with bounce
    const proTipsBtn = document.getElementById('proTipsBtn');
    const proTipsPanel = document.getElementById('proTipsPanel');
    const proTipsIcon = document.getElementById('proTipsIcon');
    let proTipsOpen = false;
    proTipsBtn.onclick = function() {
      proTipsOpen = !proTipsOpen;
      if (proTipsOpen) {
        proTipsPanel.style.maxHeight = "300px";
        proTipsPanel.style.padding = "12px 12px";
        proTipsIcon.style.transform = "rotate(90deg) scale(1.2)";
        proTipsPanel.animate([
          { transform: "scaleY(0.8)", opacity: 0.5 },
          { transform: "scaleY(1.05)", opacity: 1 },
          { transform: "scaleY(1)", opacity: 1 }
        ], { duration: 400, easing: "cubic-bezier(.4,2,.6,1)" });
      } else {
        proTipsPanel.style.maxHeight = "0";
        proTipsPanel.style.padding = "0 12px";
        proTipsIcon.style.transform = "rotate(0deg) scale(1)";
      }
    };

    // Animated SVG background: rotate and color shift
    let angle = 0, hue = 0;
    setInterval(() => {
      angle += 0.3;
      hue = (hue + 1) % 360;
      const bg = document.getElementById('mangaBg');
      if(bg) bg.style.transform = `rotate(${angle}deg)`;
      // Animate ellipse colors
      document.getElementById('bg1').setAttribute('fill', `hsl(${hue}, 80%, 55%)`);
      document.getElementById('bg2').setAttribute('fill', `hsl(${(hue+120)%360}, 80%, 65%)`);
      document.getElementById('bg3').setAttribute('fill', `hsl(${(hue+240)%360}, 100%, 98%)`);
    }, 60);

    // Start Now Button: scroll to form, bounce on click
    document.getElementById('startNowBtn').onclick = function() {
      document.getElementById('mangaForm').scrollIntoView({behavior:'smooth'});
      this.animate([
        { transform: "scale(1)" },
        { transform: "scale(1.12)" },
        { transform: "scale(0.96)" },
        { transform: "scale(1)" }
      ], { duration: 400, easing: "cubic-bezier(.4,2,.6,1)" });
    };

    // Dynamic "Did you know?" manga facts
    const facts = [
      "Did you know? The word 'manga' means 'whimsical pictures' in Japanese.",
      "Did you know? Osamu Tezuka is known as the 'God of Manga'.",
      "Did you know? Manga is read from right to left in Japan.",
      "Did you know? There are manga genres for all ages, from kids to adults.",
      "Did you know? Some manga series have sold over 100 million copies!",
      "Did you know? Many anime are adapted from popular manga.",
      "Did you know? The longest-running manga is 'Kochikame', with over 200 volumes.",
      "Did you know? Manga artists are called 'mangaka'."
    ];
    const mangaFact = document.getElementById('mangaFact');
    let factIndex = Math.floor(Math.random() * facts.length);
    function showFact() {
      mangaFact.textContent = facts[factIndex];
      factIndex = (factIndex + 1) % facts.length;
    }
    showFact();
    setInterval(showFact, 10000);
  </script>
</section>
  </section>
  
<section>
  <section class="manga-form manga-form-animated">
  <div class="manga-form-header">
    <img src="https://i.imgur.com/2yaf2wb.png" alt="Manga Pen" class="manga-form-img" />
    <div>
      <h2>Write Your Manga</h2>
      <p class="manga-form-desc">Share your story with the world! Add a cover, a catchy title, a short description, and your manga content. Choose a genre and add tags to help readers find your work.</p>
    </div>
  </div>
  <form id="mangaForm" autocomplete="off">
    <!-- Cover/Avatar Upload -->
    <div class="manga-form-upload">
      <label for="mangaCover" class="manga-form-upload-label">
        <span>Upload Cover or Avatar</span>
        <input type="file" id="mangaCover" accept="image/*" style="display:none;">
      </label>
      <div id="mangaCoverPreview" class="manga-cover-preview"></div>
    </div>
    <!-- Title -->
    <div class="floating-label">
      <input 
        type="text" 
        id="mangaTitle" 
        class="input-field" 
        maxlength="100" 
        required 
        placeholder=" "
      />
      <label for="mangaTitle">Manga Title (Max 100 characters)</label>
    </div>
    <!-- Short Description -->
    <div class="floating-label">
      <input 
        type="text" 
        id="mangaShortDesc" 
        class="input-field" 
        maxlength="150" 
        required 
        placeholder=" "
      />
      <label for="mangaShortDesc">Short Description (Max 150 characters)</label>
    </div>
    <!-- Genre -->
    <div class="floating-label">
      <select id="mangaGenre" class="input-field" required>
        <option value="" disabled selected hidden></option>
        <option>Action</option>
        <option>Adventure</option>
        <option>Comedy</option>
        <option>Drama</option>
        <option>Fantasy</option>
        <option>Romance</option>
        <option>Sci-Fi</option>
        <option>Slice of Life</option>
        <option>Sports</option>
        <option>Other</option>
      </select>
      <label for="mangaGenre">Genre</label>
    </div>
    <!-- Tags -->
    <div class="floating-label">
      <input 
        type="text" 
        id="mangaTags" 
        class="input-field" 
        maxlength="60" 
        placeholder=" "
      />
      <label for="mangaTags">Tags (comma separated, e.g. ninja,space,romance)</label>
    </div>
    <!-- Main Content -->
    <div class="floating-label">
      <textarea 
        id="mangaContent" 
        class="textarea-field" 
        rows="5" 
        maxlength="1000" 
        required
        placeholder=" "
      ></textarea>
      <label for="mangaContent">Manga Story (Max 1000 characters)</label>
      <div class="character-count" id="characterCount">0/1000</div>
    </div>
    <button type="submit" class="btn-primary post-btn-anim">Post Manga</button>
  </form>
  <style>
    .manga-form-animated {
      border-radius: 18px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.18);
      border: 3px solid;
      border-image: linear-gradient(120deg, var(--primary), var(--accent), #FFD600, var(--primary)) 1;
      animation: borderShine 3s linear infinite;
      margin-bottom: 32px;
      padding: 32px 18px 24px 18px;
      position: relative;
      overflow: hidden;
      max-width: 540px;
      margin-left: auto;
      margin-right: auto;
    }
    @keyframes borderShine {
      0% { border-image-source: linear-gradient(120deg, var(--primary), var(--accent), #FFD600, var(--primary)); }
      50% { border-image-source: linear-gradient(300deg, #FFD600, var(--primary), var(--accent), #FFD600); }
      100% { border-image-source: linear-gradient(120deg, var(--primary), var(--accent), #FFD600, var(--primary)); }
    }
    .manga-form-header {
      display: flex;
      align-items: center;
      gap: 18px;
      margin-bottom: 18px;
      justify-content: center;
      text-align: left;
    }
    .manga-form-img {
      width: 64px;
      height: 64px;
      border-radius: 50%;
      box-shadow: 0 2px 12px rgba(0,188,212,0.12);
      object-fit: cover;
      animation: floatY 2.5s ease-in-out infinite alternate;
      background: #fff;
    }
    @keyframes floatY {
      0% { transform: translateY(0);}
      100% { transform: translateY(-10px);}
    }
    .manga-form-desc {
      color: var(--muted);
      font-size: 1.05em;
      margin: 0;
    }
    .manga-form-upload {
      display: flex;
      align-items: center;
      gap: 16px;
      margin-bottom: 18px;
      justify-content: center;
    }
    .manga-form-upload-label {
      color: #fff;
      padding: 8px 18px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      font-family: 'Montserrat', sans-serif;
      font-size: 1em;
      box-shadow: 0 2px 8px rgba(0,0,0,0.10);
      transition: background 0.2s, transform 0.2s;
      outline: none;
      border: none;
      display: flex;
      align-items: center;
      gap: 8px;
      position: relative;
      z-index: 2;
    }
    .manga-form-upload-label:hover {
      background: linear-gradient(90deg, var(--accent), var(--primary));
      transform: scale(1.05);
    }
    .manga-cover-preview {
      width: 48px;
      height: 48px;
      border-radius: 8px;
      background: #eee;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0,0,0,0.10);
      display: flex;
      align-items: center;
      justify-content: center;
      animation: fadeIn 1s;
    }
    .manga-cover-preview img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 8px;
      animation: fadeIn 1s;
    }
    .floating-label {
      position: relative;
      margin-bottom: 18px;
      width: 100%;
      text-align: left;
    }
    .floating-label input,
    .floating-label textarea,
    .floating-label select {
      width: 100%;
      padding: 14px 12px 14px 12px;
      border-radius: 8px;
      border: 1.5px solid #333;
      background: #222;
      color: #fff;
      font-size: 1rem;
      transition: border-color 0.3s, background 0.4s, color 0.4s;
      outline: none;
      resize: none;
      font-family: inherit;
    }
    body.light .floating-label input,
    body.light .floating-label textarea,
    body.light .floating-label select {
      background: #f5f7fa;
      color: #23272a;
      border: 1.5px solid #bbb;
    }
    .floating-label label {
      position: absolute;
      left: 14px;
      top: 14px;
      color: var(--muted);
      font-size: 1em;
      pointer-events: none;
      background: transparent;
      transition: 0.2s cubic-bezier(.4,2,.6,1);
      z-index: 1;
    }
    .floating-label input:focus + label,
    .floating-label input:not(:placeholder-shown) + label,
    .floating-label textarea:focus + label,
    .floating-label textarea:not(:placeholder-shown) + label,
    .floating-label select:focus + label,
    .floating-label select:not([value=""]) + label {
      top: -12px;
      left: 8px;
      font-size: 0.88em;
      color: var(--primary);
      background: rgba(30,34,40,0.85);
      padding: 0 4px;
      border-radius: 4px;
      font-weight: bold;
      transition: 0.2s cubic-bezier(.4,2,.6,1);
    }
    .character-count {
      text-align: right;
      color: var(--muted);
      font-size: 0.95em;
      margin-top: 2px;
      margin-bottom: 0;
      transition: color 0.2s;
      position: absolute;
      right: 8px;
      bottom: 6px;
      z-index: 2;
      background: rgba(255,255,255,0.04);
      padding: 0 4px;
      border-radius: 4px;
    }
    .character-count.over {
      color: var(--accent);
      font-weight: bold;
      animation: shake 0.3s;
    }
    @keyframes shake {
      0% { transform: translateX(0);}
      25% { transform: translateX(-2px);}
      50% { transform: translateX(2px);}
      75% { transform: translateX(-2px);}
      100% { transform: translateX(0);}
    }
    .post-btn-anim {
      width: 100%;
      margin-top: 8px;
      background: linear-gradient(90deg, var(--primary), var(--accent));
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 14px 0;
      font-size: 1.1rem;
      font-family: 'Montserrat', sans-serif;
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(0,0,0,0.15);
      transition: transform 0.15s, box-shadow 0.15s, background 0.3s;
      animation: pulseBtn 1.8s infinite;
    }
    .post-btn-anim:hover {
      transform: translateY(-2px) scale(1.04);
      box-shadow: 0 6px 24px rgba(0,0,0,0.25);
      background: linear-gradient(90deg, var(--accent), var(--primary));
    }
    @keyframes fadeIn { from { opacity:0;} to { opacity:1;} }
    @keyframes pulseBtn {
      0% { box-shadow:0 0 0 0 rgba(0,188,212,0.18);}
      70% { box-shadow:0 0 0 10px rgba(0,188,212,0);}
      100% { box-shadow:0 0 0 0 rgba(0,188,212,0.18);}
    }
    @media (max-width: 600px) {
      .manga-form-animated { padding: 16px 4vw; }
      .manga-form-header { flex-direction: column; gap: 8px; text-align: center;}
      .manga-form-img { margin-bottom: 8px;}
    }
  </style>
  <script>
    // Cover/Avatar preview
    document.getElementById('mangaCover').addEventListener('change', function(event) {
      const file = event.target.files[0];
      const preview = document.getElementById('mangaCoverPreview');
      if (file) {
        const reader = new FileReader();
        reader.onload = () => {
          preview.innerHTML = `<img src="${reader.result}" alt="Cover Preview">`;
        };
        reader.readAsDataURL(file);
      } else {
        preview.innerHTML = '';
      }
    });

    // Floating label for select (for Chrome/Edge/Safari)
    document.getElementById('mangaGenre').addEventListener('change', function() {
      this.setAttribute('value', this.value);
    });

    // Optional: Animate Post button on submit
    document.getElementById('mangaForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const btn = document.querySelector('.post-btn-anim');
      btn.animate([
        { transform: "scale(1)" },
        { transform: "scale(1.10)" },
        { transform: "scale(0.95)" },
        { transform: "scale(1)" }
      ], { duration: 400, easing: "cubic-bezier(.4,2,.6,1)" });
      setTimeout(() => {
        alert("Your manga has been posted! (Demo only)");
        this.reset();
        document.getElementById('mangaCoverPreview').innerHTML = '';
        characterCount.textContent = "0/1000";
      }, 400);
    });
  </script>
</section>
<section>
  <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Manga Script Editor</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Google Fonts for Manga Style -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&family=Zen+Maru+Gothic:wght@700&display=swap" rel="stylesheet">
  <style>
    
    /* Animated background bubbles */
    .bg-bubble {
      position: absolute;
      border-radius: 50%;
      opacity: 0.18;
      z-index: 0;
      pointer-events: none;
      animation: floatBubble 12s infinite alternate;
    }
    .bg-bubble.b1 { width: 180px; height: 180px; left: 5vw; top: 10vh; background: var(--primary); animation-delay: 0s;}
    .bg-bubble.b2 { width: 120px; height: 120px; right: 8vw; top: 60vh; background: var(--accent); animation-delay: 2s;}
    .bg-bubble.b3 { width: 90px; height: 90px; left: 50vw; top: 80vh; background: var(--primary); animation-delay: 4s;}
    @keyframes floatBubble {
      0% { transform: translateY(0) scale(1);}
      100% { transform: translateY(-40px) scale(1.1);}
    }
    .editor-container {
      background: var(--glass);
      box-shadow: var(--shadow);
      border-radius: 24px;
      padding: 2.5rem 2rem 2rem 2rem;
      max-width: 1000px;
      width: 100%;
      margin: 2rem;
      border: 1.5px solid var(--border);
      position: relative;
      overflow: hidden;
      transition: background var(--transition), box-shadow var(--transition);
      animation: fadeInUp 1s cubic-bezier(.4,2,.6,1);
      z-index: 1;
    }
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(40px);}
      to { opacity: 1; transform: translateY(0);}
    }
    .editor-container h2 {
      font-family: 'Zen Maru Gothic', cursive;
      font-size: 2.2rem;
      letter-spacing: 1px;
      color: var(--primary);
      margin-bottom: 1.2rem;
      text-align: center;
      position: relative;
      animation: headerPop 1.2s cubic-bezier(.4,2,.6,1);
    }
    @keyframes headerPop {
      0% { transform: scale(0.8); opacity: 0;}
      80% { transform: scale(1.1);}
      100% { transform: scale(1); opacity: 1;}
    }
    .editor-container h2::after {
      content: "✦";
      color: var(--accent);
      font-size: 1.2em;
      margin-left: 0.3em;
      animation: floatStar 2.5s infinite alternate;
      vertical-align: middle;
      opacity: 0.7;
    }
    @keyframes floatStar {
      0% { transform: translateY(0);}
      100% { transform: translateY(-8px);}
    }
    .editor-toolbar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 0.7rem;
      gap: 0.5rem;
      flex-wrap: wrap;
    }
    .editor-toolbar .btn, .editor-toolbar .theme-toggle {
      margin-right: 0.2rem;
    }
    .editor-toolbar .btn:last-child {
      margin-right: 0;
    }
    .editor-toolbar .counter {
      font-size: 0.98em;
      color: var(--muted);
      margin-left: auto;
      margin-right: 0.5rem;
      user-select: none;
    }
    .editor-toolbar .tooltip {
      position: relative;
      cursor: pointer;
      color: var(--muted);
      font-size: 1.1em;
      margin-left: 0.5em;
    }
    .editor-toolbar .tooltip:hover::after {
      content: attr(data-tip);
      position: absolute;
      left: 50%;
      top: 120%;
      transform: translateX(-50%);
      background: var(--primary);
      color: #fff;
      padding: 0.4em 0.8em;
      border-radius: 8px;
      font-size: 0.95em;
      white-space: pre;
      z-index: 10;
      opacity: 1;
      pointer-events: none;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      animation: tooltipFade 0.3s;
    }
    @keyframes tooltipFade {
      from { opacity: 0; transform: translateY(10px);}
      to { opacity: 1; transform: translateY(0);}
    }
    .editor-toolbar .theme-toggle {
      background: var(--secondary);
      color: var(--primary);
      font-size: 1.2em;
      padding: 0.5em 0.9em;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-left: 0.2em;
      transition: background var(--transition), color var(--transition);
      border: none;
      outline: none;
      cursor: pointer;
    }
    .editor-toolbar .theme-toggle:hover {
      background: var(--primary);
      color: #fff;
    }
    .editor-wrapper {
      display: flex;
      background: rgba(255,255,255,0.15);
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(127,90,240,0.04);
      border: 1px solid var(--border);
      overflow: hidden;
      min-height: 320px;
      max-height: 420px;
      position: relative;
      transition: box-shadow var(--transition);
    }
    .line-numbers {
      background: linear-gradient(90deg, #e0e7ff 60%, transparent 100%);
      color: var(--muted);
      font-family: var(--editor-font);
      font-size: 1.05em;
      padding: 1.1em 0.7em 1.1em 0.7em;
      text-align: right;
      user-select: none;
      min-width: 2.2em;
      border-right: 1px solid var(--border);
      transition: background var(--transition);
    }
    [data-theme="dark"] .line-numbers {
      background: linear-gradient(90deg, #232946 60%, transparent 100%);
    }
    .editor {
      flex: 1;
      min-height: 320px;
      max-height: 420px;
      overflow-y: auto;
      outline: none;
      border: none;
      font-family: var(--editor-font);
      font-size: 1.13em;
      padding: 1.1em 1.2em;
      background: transparent;
      color: var(--secondary);
      resize: none;
      transition: background var(--transition), color var(--transition);
      caret-color: var(--primary);
      line-height: 1.7;
      letter-spacing: 0.01em;
      white-space: pre-wrap;
      word-break: break-word;
    }
    .editor:empty:before {
      content: attr(placeholder);
      color: var(--muted);
      font-style: italic;
      pointer-events: none;
      opacity: 0.7;
      animation: placeholderBlink 2.5s infinite;
    }
    @keyframes placeholderBlink {
      0%, 100% { opacity: 0.7;}
      50% { opacity: 0.3;}
    }

    #save-status {
      margin-left: 10px;
      color: var(--muted);
      font-size: 0.98em;
      transition: color 0.3s;
      min-width: 80px;
      display: inline-block;
      vertical-align: middle;
    }
    #save-status.saved {
      color: #22c55e;
      animation: statusPop 0.5s;
    }
    #save-status.saving {
      color: var(--primary);
      animation: statusPop 0.5s;
    }
    #save-status.error {
      color: var(--accent);
      animation: statusPop 0.5s;
    }
    @keyframes statusPop {
      0% { transform: scale(0.9);}
      80% { transform: scale(1.1);}
      100% { transform: scale(1);}
    }
    /* Scrollbar styling */
    .editor::-webkit-scrollbar, .line-numbers::-webkit-scrollbar {
      width: 8px;
      background: transparent;
    }
    .editor::-webkit-scrollbar-thumb, .line-numbers::-webkit-scrollbar-thumb {
      background: var(--primary);
      border-radius: 8px;
    }
    /* Responsive */
    @media (max-width: 600px) {
      .editor-container {
        padding: 1.2rem 0.5rem 1.2rem 0.5rem;
        max-width: 98vw;
      }
      .editor-wrapper {
        min-height: 180px;
        max-height: 260px;
      }
      .editor, .line-numbers {
        font-size: 1em;
        padding: 0.7em 0.5em;
      }
    }
  </style>
</head>
<body>
  <!-- Animated background bubbles -->
  <div class="bg-bubble b1"></div>
  <div class="bg-bubble b2"></div>
  <div class="bg-bubble b3"></div>
  <div class="editor-container" id="editor-container">
    <h2>Manga Script Editor</h2>
    <div class="editor-toolbar">
      <button class="btn" id="undo-btn" title="Undo (Ctrl+Z)">⟲ Undo</button>
      <button class="btn" id="redo-btn" title="Redo (Ctrl+Y)">⟳ Redo</button>
      <button class="btn" id="clear-btn" title="Clear All">🗑️ Clear</button>
      <button class="btn" id="export-btn" title="Export as TXT">⬇️ Export</button>
      <span class="counter" id="counter">0 lines, 0 words</span>
      <span class="tooltip" data-tip="Auto-saves every 5s\nCtrl+S to save\nCtrl+Z/Y to undo/redo\nCtrl+E to export\nCtrl+L to clear\nSwitch theme for day/night!">❔</span>
    </div>
    <div class="editor-wrapper">
      <div class="line-numbers" id="line-numbers">1</div>
      <div id="editor" contenteditable="true" class="editor" placeholder="Start scripting your manga...&#10;E.g.&#10;[Panel 1] A rainy Tokyo street.&#10;[SFX] Drip drip...&#10;[Character] 'Where is he?'"></div>
    </div>
    <div style="margin-top:1.2em; text-align:right;">
      <button id="save-script" class="btn">💾 Save Script</button>
      <span id="save-status"></span>
    </div>
  </div>
  <script>
    // --- Editor, Line Numbers, Counter ---
    const editor = document.getElementById('editor');
    const lineNumbers = document.getElementById('line-numbers');
    const counter = document.getElementById('counter');
    const saveStatus = document.getElementById('save-status');
    let lastSaved = '';
    let saveTimeout = null;
    let autoSaveInterval = null;

    // Undo/Redo Stack
    let undoStack = [];
    let redoStack = [];
    let isTyping = false;
    let lastContent = '';

    // --- Helper Functions ---
    function getEditorText() {
      return editor.innerText.replace(/\r\n/g, '\n');
    }
    function setEditorText(text) {
      editor.innerText = text;
      updateLineNumbers();
      updateCounter();
    }
    function updateLineNumbers() {
      const lines = getEditorText().split('\n').length;
      let nums = '';
      for (let i = 1; i <= lines; i++) nums += i + '\n';
      lineNumbers.innerText = nums.trimEnd();
    }
    function updateCounter() {
      const text = getEditorText();
      const lines = text.split('\n').length;
      const words = text.match(/\b\w+\b/g)?.length || 0;
      const chars = text.length;
      counter.innerText = `${lines} line${lines>1?'s':''}, ${words} word${words!==1?'s':''}`;
    }
    function showStatus(msg, type='saved') {
      saveStatus.innerText = msg;
      saveStatus.className = type;
      setTimeout(() => {
        if (saveStatus.innerText === msg) saveStatus.className = '';
      }, 1200);
    }
    function saveScript(manual=false) {
      const text = getEditorText();
      try {
        localStorage.setItem('manga-script', text);
        lastSaved = text;
        showStatus(manual ? 'Saved!' : 'Auto-saved', 'saved');
      } catch (e) {
        showStatus('Save error!', 'error');
      }
    }
    function loadScript() {
      const saved = localStorage.getItem('manga-script');
      if (saved) setEditorText(saved);
    }
    function exportScript() {
      const text = getEditorText();
      const blob = new Blob([text], {type: 'text/plain'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'manga-script.txt';
      document.body.appendChild(a);
      a.click();
      setTimeout(() => {
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
      }, 100);
      showStatus('Exported!', 'saved');
    }
    function clearScript() {
      if (confirm('Clear all script?')) {
        setEditorText('');
        undoStack = [];
        redoStack = [];
        saveScript(true);
      }
    }
    function pushUndo() {
      if (isTyping) return;
      const text = getEditorText();
      if (undoStack.length === 0 || undoStack[undoStack.length-1] !== text) {
        undoStack.push(text);
        if (undoStack.length > 100) undoStack.shift();
        redoStack = [];
      }
    }
    function undo() {
      if (undoStack.length > 1) {
        redoStack.push(undoStack.pop());
        setEditorText(undoStack[undoStack.length-1]);
      }
    }
    function redo() {
      if (redoStack.length > 0) {
        const text = redoStack.pop();
        setEditorText(text);
        undoStack.push(text);
      }
    }
    // --- Event Listeners ---
    editor.addEventListener('input', () => {
      updateLineNumbers();
      updateCounter();
      pushUndo();
      if (saveTimeout) clearTimeout(saveTimeout);
      saveStatus.innerText = 'Saving...';
      saveStatus.className = 'saving';
      saveTimeout = setTimeout(() => saveScript(false), 800);
    });
    editor.addEventListener('keydown', e => {
      // Tab inserts 2 spaces
      if (e.key === 'Tab') {
        e.preventDefault();
        document.execCommand('insertText', false, '  ');
      }
    });
    // Undo/Redo with keyboard
    document.addEventListener('keydown', e => {
      if (e.ctrlKey && e.key.toLowerCase() === 'z') { e.preventDefault(); undo(); }
      if (e.ctrlKey && e.key.toLowerCase() === 'y') { e.preventDefault(); redo(); }
      if (e.ctrlKey && e.key.toLowerCase() === 's') { e.preventDefault(); saveScript(true);}
      if (e.ctrlKey && e.key.toLowerCase() === 'e') { e.preventDefault(); exportScript();}
      if (e.ctrlKey && e.key.toLowerCase() === 'l') { e.preventDefault(); clearScript();}
    });
    // Buttons
    document.getElementById('undo-btn').onclick = undo;
    document.getElementById('redo-btn').onclick = redo;
    document.getElementById('clear-btn').onclick = clearScript;
    document.getElementById('export-btn').onclick = exportScript;
    document.getElementById('save-script').onclick = () => saveScript(true);

    // --- Auto-save every 5s ---
    autoSaveInterval = setInterval(() => {
      if (getEditorText() !== lastSaved) saveScript(false);
    }, 5000);

    // --- Initial Load ---
    window.onload = () => {
      loadScript();
      updateLineNumbers();
      updateCounter();
      // For undo stack
      undoStack = [getEditorText()];
      // Focus editor without scrolling
      setTimeout(() => {
        editor.focus({ preventScroll: true });
      }, 400);
    };

    // --- Animated Placeholder on Focus/Blur ---
    editor.addEventListener('focus', () => {
      editor.classList.add('focused');
    });
    editor.addEventListener('blur', () => {
      editor.classList.remove('focused');
    });

    // --- Drag & Drop TXT Import ---
    editor.addEventListener('dragover', e => {
      e.preventDefault();
      editor.style.background = 'rgba(127,90,240,0.08)';
    });
    editor.addEventListener('dragleave', e => {
      editor.style.background = 'transparent';
    });
    editor.addEventListener('drop', e => {
      e.preventDefault();
      editor.style.background = 'transparent';
      const file = e.dataTransfer.files[0];
      if (file && file.type === 'text/plain') {
        const reader = new FileReader();
        reader.onload = function(evt) {
          setEditorText(evt.target.result);
          showStatus('Imported!', 'saved');
        };
        reader.readAsText(file);
      }
    });

    // --- Sync Scroll for Line Numbers ---
    editor.addEventListener('scroll', () => {
      lineNumbers.scrollTop = editor.scrollTop;
    });

    // --- Responsive Resize Observer for Editor Height ---
    if ('ResizeObserver' in window) {
      new ResizeObserver(() => {
        updateLineNumbers();
      }).observe(editor);
    }

    // --- Easter Egg: Konami Code for fun! ---
    let konami = [];
    const code = [38,38,40,40,37,39,37,39,66,65];
    document.addEventListener('keydown', e => {
      konami.push(e.keyCode);
      if (konami.length > code.length) konami.shift();
      if (konami.toString() === code.toString()) {
        showStatus('✨ Secret Unlocked! ✨', 'saved');
        setTimeout(() => {
          setEditorText('[Panel 1] A mysterious power surges through the editor...\n[SFX] DUN DUN DUN!');
        }, 800);
      }
    });

    // --- Mobile: Double tap to select all ---
    let lastTap = 0;
    editor.addEventListener('touchend', e => {
      const now = Date.now();
      if (now - lastTap < 400) {
        document.execCommand('selectAll', false, null);
      }
      lastTap = now;
    });

    // --- Animated Save Button ---
    document.getElementById('save-script').addEventListener('mousedown', function() {
      this.style.transform = 'scale(0.95)';
    });
    document.getElementById('save-script').addEventListener('mouseup', function() {
      this.style.transform = '';
    });

    // --- Prevent accidental navigation away ---
    window.addEventListener('beforeunload', function (e) {
      if (getEditorText() !== lastSaved) {
        e.preventDefault();
        e.returnValue = '';
      }
    });
  </script>
</body>
</section>
    <!-- Manga Cover Upload -->
    <section>
      <section style="display:flex;justify-content:center;align-items:center;min-height:100vh;background:linear-gradient(135deg,#f4f4f8 0%,#e0e7ff 100%);position:relative;overflow:hidden;">
  <!-- Animated background bubbles -->
  <div style="position:absolute;left:5vw;top:10vh;width:120px;height:120px;background:#7f5af0;opacity:0.13;border-radius:50%;z-index:0;animation:floatBubble 12s infinite alternate;"></div>
  <div style="position:absolute;right:8vw;top:60vh;width:80px;height:80px;background:#f25f4c;opacity:0.13;border-radius:50%;z-index:0;animation:floatBubble 10s 2s infinite alternate;"></div>
  <style>
    @keyframes floatBubble {0%{transform:translateY(0) scale(1);}100%{transform:translateY(-40px) scale(1.1);}}
    .upload-container {
      box-shadow: 0 8px 32px 0 rgba(31,38,135,0.15);
      border-radius: 24px;
      padding: 2.5rem 2rem 2rem 2rem;
      max-width: 100%;
      width: 100%;
      border: 1.5px solid rgba(127,90,240,0.15);
      position: relative;
      z-index: 1;
      animation: fadeInUp 1s cubic-bezier(.4,2,.6,1);
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    @keyframes fadeInUp {from{opacity:0;transform:translateY(40px);}to{opacity:1;transform:translateY(0);}}
    .upload-container h2 {
      font-family: 'Zen Maru Gothic', cursive;
      font-size: 2rem;
      color: #7f5af0;
      margin-bottom: 1.2rem;
      text-align: center;
      letter-spacing: 1px;
      position: relative;
      animation: headerPop 1.2s cubic-bezier(.4,2,.6,1);
    }
    @keyframes headerPop {0%{transform:scale(0.8);opacity:0;}80%{transform:scale(1.1);}100%{transform:scale(1);opacity:1;}}
    .drop-area {
      width: 220px;
      height: 320px;
      border: 2.5px dashed #7f5af0;
      border-radius: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      cursor: pointer;
      margin-bottom: 1.2em;
      transition: border-color 0.3s, background 0.3s;
      position: relative;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(127,90,240,0.04);
      animation: dropPop 0.8s;
    }
    @keyframes dropPop {0%{transform:scale(0.95);opacity:0;}100%{transform:scale(1);opacity:1;}}
    .drop-area.dragover {
      border-color: #f25f4c;
      background: rgba(242,95,76,0.09);
    }
    .drop-area input[type="file"] {
      display: none;
    }
    .drop-area .upload-icon {
      font-size: 2.5em;
      color: #7f5af0;
      margin-bottom: 0.3em;
      transition: color 0.3s;
      pointer-events: none;
    }
    .drop-area.dragover .upload-icon {
      color: #f25f4c;
    }
    .drop-area .upload-text {
      color: #7f5af0;
      font-size: 1.1em;
      text-align: center;
      pointer-events: none;
      font-family: 'Roboto Mono', monospace;
      opacity: 0.8;
    }
    .drop-area .upload-tip {
      color: #6b7280;
      font-size: 0.95em;
      margin-top: 0.3em;
      pointer-events: none;
      text-align: center;
    }
    #cover-preview {
      width: 220px;
      height: 320px;
      border-radius: 16px;
      overflow: hidden;
      box-shadow: 0 4px 24px 0 rgba(127,90,240,0.13);
      margin-bottom: 1.1em;
      position: relative;
      display: none;
      background: #fff;
      animation: fadeInPreview 0.7s;
    }
    @keyframes fadeInPreview {from{opacity:0;transform:scale(0.97);}to{opacity:1;transform:scale(1);}}
    #cover-preview img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.3s;
      cursor: zoom-in;
      border-radius: 16px;
      background: #fff;
    }
    #cover-preview img:active {
      transform: scale(1.08);
      cursor: zoom-out;
    }
    .remove-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      background: #f25f4c;
      color: #fff;
      border: none;
      border-radius: 50%;
      width: 32px;
      height: 32px;
      font-size: 1.2em;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(242,95,76,0.13);
      transition: background 0.2s, transform 0.15s;
      z-index: 2;
    }
    .remove-btn:hover { background: #d32f2f; transform: scale(1.1);}
    .upload-status {
      min-height: 1.2em;
      color: #7f5af0;
      font-size: 1em;
      text-align: center;
      margin-bottom: 0.7em;
      transition: color 0.3s;
      font-family: 'Roboto Mono', monospace;
    }
    .upload-status.error { color: #f25f4c; }
    .upload-btn {
      background: #7f5af0;
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 0.7em 1.5em;
      font-size: 1.1em;
      font-family: inherit;
      cursor: pointer;
      margin-top: 0.2em;
      box-shadow: 0 2px 8px rgba(127,90,240,0.08);
      transition: background 0.3s, transform 0.15s;
      outline: none;
      position: relative;
      overflow: hidden;
      font-weight: 700;
      letter-spacing: 0.03em;
      animation: btnPop 0.7s;
    }
    @keyframes btnPop {0%{transform:scale(0.95);opacity:0;}100%{transform:scale(1);opacity:1;}}
    .upload-btn:active { transform: scale(0.97);}
    .upload-btn:hover { background: #f25f4c; color: #fff;}
    @media (max-width: 500px) {
      .upload-container {padding:1.2rem 0.5rem 1.2rem 0.5rem;max-width:98vw;}
      .drop-area, #cover-preview {width: 98vw;max-width: 220px;}
    }
  </style>
  <div class="upload-container">
    <h2>Upload Manga Cover</h2>
    <div class="drop-area" id="drop-area">
      <span class="upload-icon">📚</span>
      <span class="upload-text">Drag & Drop or Click to Upload</span>
      <span class="upload-tip">PNG, JPG, JPEG, GIF • Max 2MB</span>
      <input type="file" id="cover-upload" accept="image/*">
    </div>
    <div id="cover-preview"></div>
    <div class="upload-status" id="upload-status"></div>
    <button class="upload-btn" id="upload-btn" style="display:none;">Upload</button>
  </div>
  <script>
    // Elements
    const dropArea = document.getElementById('drop-area');
    const fileInput = document.getElementById('cover-upload');
    const preview = document.getElementById('cover-preview');
    const status = document.getElementById('upload-status');
    const uploadBtn = document.getElementById('upload-btn');
    let selectedFile = null;

    // Drag & Drop
    ['dragenter','dragover'].forEach(evt =>
      dropArea.addEventListener(evt, e => {
        e.preventDefault(); e.stopPropagation();
        dropArea.classList.add('dragover');
      })
    );
    ['dragleave','drop'].forEach(evt =>
      dropArea.addEventListener(evt, e => {
        e.preventDefault(); e.stopPropagation();
        dropArea.classList.remove('dragover');
      })
    );
    dropArea.addEventListener('drop', e => {
      if (e.dataTransfer.files && e.dataTransfer.files[0]) {
        handleFile(e.dataTransfer.files[0]);
      }
    });
    // Click to open file dialog
    dropArea.addEventListener('click', () => fileInput.click());
    fileInput.addEventListener('change', e => {
      if (e.target.files && e.target.files[0]) {
        handleFile(e.target.files[0]);
      }
    });

    // File validation and preview
    function handleFile(file) {
      if (!file.type.match(/^image\//)) {
        showStatus('Only image files allowed!', true); return;
      }
      if (file.size > 2*1024*1024) {
        showStatus('Max size is 2MB!', true); return;
      }
      selectedFile = file;
      const reader = new FileReader();
      reader.onload = function(e) {
        preview.innerHTML = `<img src="${e.target.result}" alt="Manga Cover" id="cover-img">
          <button class="remove-btn" title="Remove Cover" id="remove-btn">✕</button>`;
        preview.style.display = 'block';
        uploadBtn.style.display = 'inline-block';
        showStatus('Ready to upload!');
        // Remove button
        document.getElementById('remove-btn').onclick = () => {
          preview.innerHTML = '';
          preview.style.display = 'none';
          fileInput.value = '';
          selectedFile = null;
          uploadBtn.style.display = 'none';
          showStatus('');
        };
        // Zoom on click
        document.getElementById('cover-img').onclick = function() {
          if (this.style.transform) {
            this.style.transform = '';
            this.style.zIndex = '';
          } else {
            this.style.transform = 'scale(1.5)';
            this.style.zIndex = '10';
          }
        };
      };
      reader.readAsDataURL(file);
    }

    // Show status
    function showStatus(msg, error) {
      status.textContent = msg;
      status.className = 'upload-status' + (error ? ' error' : '');
    }

    // Fake upload
    uploadBtn.onclick = function() {
      if (!selectedFile) return;
      showStatus('Uploading...');
      uploadBtn.disabled = true;
      setTimeout(() => {
        showStatus('Upload successful! 🎉');
        uploadBtn.disabled = false;
        uploadBtn.style.display = 'none';
      }, 1200);
    };
  </script>
</section>
    </section>

    <!-- Manga Feed -->
    <section>
      <!-- Manga Feed Section - Feature Rich UI -->
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
<style>
.feed-container {
  max-width: 1100px;
  margin: 40px auto;
  background: var(--card-bg);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  padding: 36px 32px 32px 32px;
  position: relative;
  overflow: hidden;
}
.feed-header {
  display: flex;
  align-items: center;
  gap: 16px;
  margin-bottom: 18px;
}
.feed-header .icon {
  font-size: 2.2rem;
  color: var(--primary);
  animation: popIn 0.7s cubic-bezier(.4,2,.6,1);
}
@keyframes popIn {
  0% { transform: scale(0.7) rotate(-10deg); opacity: 0; }
  100% { transform: scale(1) rotate(0); opacity: 1; }
}
.feed-header h2 {
  font-size: 2.1rem;
  font-weight: 700;
  margin: 0;
  letter-spacing: 1px;
}
.feed-searchbar {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 24px;
}
.feed-searchbar input {
  flex: 1;
  padding: 10px 16px;
  border-radius: 8px;
  border: 1px solid var(--border);
  font-size: 1rem;
  background: var(--bg);
  color: var(--text);
  transition: border var(--transition);
}
.feed-searchbar input:focus {
  border-color: var(--primary);
  outline: none;
}
.feed-searchbar select {
  padding: 8px 12px;
  border-radius: 8px;
  border: 1px solid var(--border);
  background: var(--bg);
  color: var(--text);
  font-size: 1rem;
}
#feed {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
  gap: 28px;
  min-height: 400px;
}
.manga-card {
  background: var(--card-bg);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  overflow: hidden;
  display: flex;
  flex-direction: column;
  transition: transform var(--transition), box-shadow var(--transition);
  position: relative;
  min-height: 420px;
  cursor: pointer;
  border: 1.5px solid transparent;
}
.manga-card:hover, .manga-card:focus-within {
  transform: translateY(-6px) scale(1.025);
  box-shadow: 0 8px 32px 0 rgba(108,99,255,0.13);
  border-color: var(--primary);
  z-index: 2;
}
.manga-cover {
  width: 100%;
  aspect-ratio: 3/4;
  object-fit: cover;
  background: var(--skeleton);
  transition: filter 0.2s;
  border-bottom: 1px solid var(--border);
}
.manga-card:hover .manga-cover {
  filter: brightness(0.93) saturate(1.1);
}
.manga-content {
  padding: 18px 16px 12px 16px;
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 8px;
}
.manga-title {
  font-size: 1.13rem;
  font-weight: 700;
  margin: 0 0 2px 0;
  color: var(--text);
  text-overflow: ellipsis;
  white-space: nowrap;
  overflow: hidden;
}
.manga-author {
  font-size: 0.97rem;
  color: var(--muted);
  margin-bottom: 2px;
}
.manga-desc {
  font-size: 0.97rem;
  color: var(--muted);
  margin-bottom: 6px;
  display: -webkit-box;
  -webkit-box-orient: vertical;
  overflow: hidden;
  min-height: 48px;
}
.manga-genres {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  margin-bottom: 6px;
}
.genre-tag {
  background: linear-gradient(90deg, var(--primary) 60%, var(--secondary) 100%);
  color: #fff;
  font-size: 0.82rem;
  padding: 2px 10px;
  border-radius: 12px;
  font-weight: 600;
  letter-spacing: 0.5px;
  box-shadow: 0 1px 4px 0 rgba(108,99,255,0.08);
  user-select: none;
  transition: background 0.2s;
}
.manga-meta {
  display: flex;
  align-items: center;
  gap: 10px;
  font-size: 0.93rem;
  color: var(--muted);
  margin-top: 2px;
}
.manga-rating {
  color: #ffb400;
  font-weight: 700;
  display: flex;
  align-items: center;
  gap: 2px;
}
.manga-status {
  font-size: 0.85rem;
  padding: 2px 8px;
  border-radius: 8px;
  background: #e0e7ff;
  color: #4f46e5;
  font-weight: 600;
  margin-left: auto;
}
[data-theme="dark"] .manga-status {
  background: #2e2e4a;
  color: #a5b4fc;
}
.manga-actions {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-top: 8px;
}
.bookmark-btn {
  background: none;
  border: none;
  color: var(--muted);
  font-size: 1.3rem;
  cursor: pointer;
  transition: color var(--transition), transform 0.15s;
  position: relative;
}
.bookmark-btn.active {
  color: var(--secondary);
  transform: scale(1.2) rotate(-10deg);
}
.bookmark-btn:focus {
  outline: 2px solid var(--primary);
}
.tooltip {
  position: absolute;
  bottom: 110%;
  left: 50%;
  transform: translateX(-50%);
  background: var(--card-bg);
  color: var(--text);
  padding: 4px 10px;
  border-radius: 8px;
  font-size: 0.85rem;
  box-shadow: 0 2px 8px 0 rgba(0,0,0,0.08);
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.2s;
  z-index: 10;
}
.bookmark-btn:hover .tooltip, .bookmark-btn:focus .tooltip {
  opacity: 1;
}
.skeleton-card {
  background: var(--skeleton);
  border-radius: var(--radius);
  min-height: 420px;
  animation: skeletonPulse 1.2s infinite alternate;
}
@keyframes skeletonPulse {
  0% { opacity: 0.7; }
  100% { opacity: 1; }
}
::-webkit-scrollbar {
  width: 10px;
  background: var(--bg);
}
::-webkit-scrollbar-thumb {
  background: var(--scrollbar);
  border-radius: 8px;
}
@media (max-width: 700px) {
  .feed-container { padding: 18px 6px 18px 6px; }
  .feed-header h2 { font-size: 1.3rem; }
  #feed { gap: 16px; }
}
.pagination {
  display: flex;
  justify-content: center;
  gap: 8px;
  margin: 32px 0 0 0;
}
.page-btn {
  background: var(--bg);
  border: 1px solid var(--border);
  color: var(--text);
  font-size: 1rem;
  padding: 6px 14px;
  border-radius: 8px;
  cursor: pointer;
  transition: background var(--transition), color var(--transition), border var(--transition);
}
.page-btn.active, .page-btn:hover {
  background: var(--primary);
  color: #fff;
  border-color: var(--primary);
}
@media (max-width: 500px) {
  .feed-header { flex-direction: column; align-items: flex-start; gap: 6px; }
  .feed-searchbar { flex-direction: column; gap: 8px; }
  .pagination { gap: 4px; }
}
</style>

<div class="feed-container" id="manga-feed-section">
  <div class="feed-header">
    <span class="icon" aria-hidden="true">📚</span>
    <h2>Explore Manga Stories</h2>
  </div>
  <div class="feed-searchbar">
    <input type="text" id="searchInput" placeholder="Search manga by title, author, or genre..." aria-label="Search manga">
    <select id="genreFilter" aria-label="Filter by genre">
      <option value="">All Genres</option>
      <option>Action</option>
      <option>Adventure</option>
      <option>Comedy</option>
      <option>Drama</option>
      <option>Fantasy</option>
      <option>Romance</option>
      <option>Slice of Life</option>
      <option>Horror</option>
      <option>Sci-Fi</option>
      <option>Sports</option>
      <option>Supernatural</option>
      <option>Historical</option>
    </select>
  </div>
  <div id="feed" aria-live="polite"></div>
  <div class="pagination" id="pagination"></div>
</div>

<script>
// --- Sample Manga Data (Replace with API or your own data) ---
const mangaData = [
  {
    id: 1,
    title: "Demon Slayer: Kimetsu no Yaiba",
    author: "Koyoharu Gotouge",
    cover: "https://cdn.myanimelist.net/images/manga/3/191017.jpg",
    desc: "After his family is slaughtered by demons, Tanjiro Kamado's journey to save his sister and avenge his family begins.",
    genres: ["Action", "Supernatural", "Historical"],
    rating: 4.8,
    status: "Completed"
  },
  {
    id: 2,
    title: "One Piece",
    author: "Eiichiro Oda",
    cover: "https://cdn.myanimelist.net/images/manga/2/253146.jpg",
    desc: "Monkey D. Luffy sails the Grand Line with his crew in search of the legendary treasure, One Piece.",
    genres: ["Action", "Adventure", "Comedy"],
    rating: 4.9,
    status: "Ongoing"
  },
  {
    id: 3,
    title: "Attack on Titan",
    author: "Hajime Isayama",
    cover: "https://cdn.myanimelist.net/images/manga/1/54525.jpg",
    desc: "Humanity fights for survival against man-eating giants known as Titans.",
    genres: ["Action", "Drama", "Horror"],
    rating: 4.7,
    status: "Completed"
  },
  {
    id: 4,
    title: "My Hero Academia",
    author: "Kohei Horikoshi",
    cover: "https://cdn.myanimelist.net/images/manga/3/178228.jpg",
    desc: "In a world where superpowers are the norm, Izuku Midoriya dreams of becoming a hero.",
    genres: ["Action", "Comedy", "Supernatural"],
    rating: 4.6,
    status: "Ongoing"
  },
  {
    id: 5,
    title: "Spy x Family",
    author: "Tatsuya Endo",
    cover: "https://cdn.myanimelist.net/images/manga/3/222841.jpg",
    desc: "A spy, an assassin, and a telepath form a fake family for a secret mission.",
    genres: ["Action", "Comedy", "Slice of Life"],
    rating: 4.8,
    status: "Ongoing"
  },
  {
    id: 6,
    title: "Death Note",
    author: "Tsugumi Ohba",
    cover: "https://cdn.myanimelist.net/images/manga/2/54425.jpg",
    desc: "A high school student discovers a notebook that allows him to kill anyone by writing their name.",
    genres: ["Drama", "Supernatural", "Mystery"],
    rating: 4.9,
    status: "Completed"
  },
  {
    id: 7,
    title: "Haikyuu!!",
    author: "Haruichi Furudate",
    cover: "https://cdn.myanimelist.net/images/manga/2/253801.jpg",
    desc: "Shoyo Hinata aims to become a top volleyball player despite his short stature.",
    genres: ["Sports", "Comedy", "Drama"],
    rating: 4.7,
    status: "Completed"
  },
  {
    id: 8,
    title: "Fruits Basket",
    author: "Natsuki Takaya",
    cover: "https://cdn.myanimelist.net/images/manga/2/258224.jpg",
    desc: "Tohru Honda discovers the secret of the Sohma family, who are cursed to transform into animals of the zodiac.",
    genres: ["Romance", "Drama", "Supernatural"],
    rating: 4.6,
    status: "Completed"
  },
  {
    id: 9,
    title: "Blue Lock",
    author: "Muneyuki Kaneshiro",
    cover: "https://cdn.myanimelist.net/images/manga/3/222842.jpg",
    desc: "Japan's search for the ultimate striker leads to a brutal soccer competition.",
    genres: ["Sports", "Action", "Drama"],
    rating: 4.5,
    status: "Ongoing"
  },
  {
    id: 10,
    title: "Chainsaw Man",
    author: "Tatsuki Fujimoto",
    cover: "https://cdn.myanimelist.net/images/manga/3/222843.jpg",
    desc: "Denji, a devil hunter, merges with his pet devil Pochita to become Chainsaw Man.",
    genres: ["Action", "Horror", "Supernatural"],
    rating: 4.8,
    status: "Ongoing"
  },
  {
    id: 11,
    title: "Komi Can't Communicate",
    author: "Tomohito Oda",
    cover: "https://cdn.myanimelist.net/images/manga/2/253802.jpg",
    desc: "Komi Shouko struggles with communication, but dreams of making 100 friends.",
    genres: ["Comedy", "Slice of Life", "Romance"],
    rating: 4.4,
    status: "Ongoing"
  },
  {
    id: 12,
    title: "Tokyo Ghoul",
    author: "Sui Ishida",
    cover: "https://cdn.myanimelist.net/images/manga/3/222844.jpg",
    desc: "Ken Kaneki becomes a half-ghoul after a deadly encounter, struggling to survive in a world of monsters.",
    genres: ["Horror", "Drama", "Supernatural"],
    rating: 4.7,
    status: "Completed"
  },
  // ...add more manga as needed
];

// --- State ---
let filteredManga = [...mangaData];
let bookmarks = JSON.parse(localStorage.getItem('mangaBookmarks') || '[]');
let currentPage = 1;
const pageSize = 6;

// --- Utility Functions ---
function saveBookmarks() {
  localStorage.setItem('mangaBookmarks', JSON.stringify(bookmarks));
}
function isBookmarked(id) {
  return bookmarks.includes(id);
}
function toggleBookmark(id) {
  if (isBookmarked(id)) {
    bookmarks = bookmarks.filter(bid => bid !== id);
  } else {
    bookmarks.push(id);
  }
  saveBookmarks();
  renderFeed();
}

// --- Search & Filter ---
function filterManga() {
  const search = document.getElementById('searchInput').value.trim().toLowerCase();
  const genre = document.getElementById('genreFilter').value;
  filteredManga = mangaData.filter(manga => {
    const matchesSearch =
      manga.title.toLowerCase().includes(search) ||
      manga.author.toLowerCase().includes(search) ||
      manga.genres.some(g => g.toLowerCase().includes(search));
    const matchesGenre = !genre || manga.genres.includes(genre);
    return matchesSearch && matchesGenre;
  });
  currentPage = 1;
  renderFeed();
}

// --- Pagination ---
function renderPagination() {
  const totalPages = Math.ceil(filteredManga.length / pageSize);
  const pag = document.getElementById('pagination');
  pag.innerHTML = '';
  if (totalPages <= 1) return;
  for (let i = 1; i <= totalPages; i++) {
    const btn = document.createElement('button');
    btn.className = 'page-btn' + (i === currentPage ? ' active' : '');
    btn.textContent = i;
    btn.onclick = () => {
      currentPage = i;
      renderFeed();
      window.scrollTo({ top: document.getElementById('manga-feed-section').offsetTop - 20, behavior: 'smooth' });
    };
    pag.appendChild(btn);
  }
}

// --- Manga Card Rendering ---
function renderFeed() {
  const feed = document.getElementById('feed');
  feed.innerHTML = '';
  // Skeleton loading effect
  if (filteredManga.length === 0) {
    for (let i = 0; i < 3; i++) {
      const skel = document.createElement('div');
      skel.className = 'skeleton-card';
      feed.appendChild(skel);
    }
    setTimeout(() => {
      feed.innerHTML = '<div style="grid-column: 1/-1; text-align:center; color:var(--muted); font-size:1.1rem; margin-top:40px;">No manga found. Try a different search or filter.</div>';
    }, 800);
    renderPagination();
    return;
  }
  // Pagination
  const start = (currentPage - 1) * pageSize;
  const end = start + pageSize;
  const pageManga = filteredManga.slice(start, end);
  pageManga.forEach(manga => {
    const card = document.createElement('div');
    card.className = 'manga-card';
    card.tabIndex = 0;
    card.setAttribute('aria-label', manga.title + " by " + manga.author);

    // Cover
    const cover = document.createElement('img');
    cover.className = 'manga-cover';
    cover.src = manga.cover;
    cover.alt = manga.title + " cover";
    card.appendChild(cover);

    // Content
    const content = document.createElement('div');
    content.className = 'manga-content';

    // Title
    const title = document.createElement('div');
    title.className = 'manga-title';
    title.textContent = manga.title;
    content.appendChild(title);

    // Author
    const author = document.createElement('div');
    author.className = 'manga-author';
    author.textContent = "by " + manga.author;
    content.appendChild(author);

    // Description
    const desc = document.createElement('div');
    desc.className = 'manga-desc';
    desc.textContent = manga.desc;
    content.appendChild(desc);

    // Genres
    const genres = document.createElement('div');
    genres.className = 'manga-genres';
    manga.genres.forEach(g => {
      const tag = document.createElement('span');
      tag.className = 'genre-tag';
      tag.textContent = g;
      genres.appendChild(tag);
    });
    content.appendChild(genres);

    // Meta
    const meta = document.createElement('div');
    meta.className = 'manga-meta';
    // Rating
    const rating = document.createElement('span');
    rating.className = 'manga-rating';
    rating.innerHTML = '★ ' + manga.rating;
    meta.appendChild(rating);
    // Status
    const status = document.createElement('span');
    status.className = 'manga-status';
    status.textContent = manga.status;
    meta.appendChild(status);
    content.appendChild(meta);

    // Actions
    const actions = document.createElement('div');
    actions.className = 'manga-actions';
    // Bookmark
    const bookmark = document.createElement('button');
    bookmark.className = 'bookmark-btn' + (isBookmarked(manga.id) ? ' active' : '');
    bookmark.innerHTML = isBookmarked(manga.id) ? '❤️' : '🤍';
    bookmark.setAttribute('aria-label', isBookmarked(manga.id) ? 'Remove from favorites' : 'Add to favorites');
    bookmark.onclick = (e) => {
      e.stopPropagation();
      toggleBookmark(manga.id);
    };
    // Tooltip
    const tooltip = document.createElement('span');
    tooltip.className = 'tooltip';
    tooltip.textContent = isBookmarked(manga.id) ? 'Remove from favorites' : 'Add to favorites';
    bookmark.appendChild(tooltip);
    actions.appendChild(bookmark);

    content.appendChild(actions);

    card.appendChild(content);

    // Card click: show more info (modal or link)
    card.onclick = (e) => {
      if (e.target === bookmark) return;
      showMangaModal(manga);
    };

    feed.appendChild(card);
  });
  renderPagination();
}

// --- Modal for Manga Details ---
function showMangaModal(manga) {
  // Remove existing modal
  const old = document.getElementById('mangaModal');
  if (old) old.remove();

  const modal = document.createElement('div');
  modal.id = 'mangaModal';
  modal.style = `
    position:fixed; top:0; left:0; width:100vw; height:100vh; z-index:9999;
    background:rgba(0,0,0,0.45); display:flex; align-items:center; justify-content:center;
    animation: fadeIn 0.3s;
  `;
  modal.innerHTML = `
    <div style="
      background:var(--card-bg); color:var(--text); border-radius:22px; max-width:420px; width:95vw;
      box-shadow:0 8px 40px 0 rgba(0,0,0,0.18); padding:32px 24px 24px 24px; position:relative; animation: popIn 0.4s;
    ">
      <button aria-label="Close" style="
        position:absolute; top:18px; right:18px; background:none; border:none; font-size:1.5rem; color:var(--muted); cursor:pointer;
        transition:color 0.2s;
      " onclick="document.getElementById('mangaModal').remove()">✖️</button>
      <img src="${manga.cover}" alt="${manga.title} cover" style="width:120px; border-radius:14px; box-shadow:0 2px 12px 0 rgba(0,0,0,0.08); display:block; margin:0 auto 18px auto;">
      <h3 style="text-align:center; margin:0 0 8px 0; font-size:1.3rem;">${manga.title}</h3>
      <div style="text-align:center; color:var(--muted); margin-bottom:10px;">by ${manga.author}</div>
      <div style="font-size:1.05rem; margin-bottom:12px; color:var(--text);">${manga.desc}</div>
      <div style="display:flex; flex-wrap:wrap; gap:6px; justify-content:center; margin-bottom:10px;">
        ${manga.genres.map(g => `<span class="genre-tag">${g}</span>`).join('')}
      </div>
      <div style="display:flex; align-items:center; justify-content:center; gap:16px; margin-bottom:10px;">
        <span class="manga-rating" style="font-size:1.1rem;">★ ${manga.rating}</span>
        <span class="manga-status" style="font-size:0.95rem;">${manga.status}</span>
      </div>
      <button class="bookmark-btn${isBookmarked(manga.id) ? ' active' : ''}" style="margin:0 auto; display:block; font-size:1.5rem;" onclick="toggleBookmark(${manga.id}); document.getElementById('mangaModal').remove();">
        ${isBookmarked(manga.id) ? '❤️ Remove from favorites' : '🤍 Add to favorites'}
      </button>
    </div>
  `;
  document.body.appendChild(modal);
  modal.onclick = (e) => { if (e.target === modal) modal.remove(); };
}

// --- Event Listeners ---
document.getElementById('searchInput').addEventListener('input', filterManga);
document.getElementById('genreFilter').addEventListener('change', filterManga);

// --- Initial Render ---
filterManga();

// --- Expose for modal bookmark button ---
window.toggleBookmark = toggleBookmark;
</script>
    </section>
    <!-- Login Form -->
    <div class="form-box">
      <h2>Log In</h2>
      <form id="loginForm" autocomplete="off">
        <div class="input-group">
          <label for="email">Email</label>
          <input type="email" id="email" name="email" placeholder="Enter your email" required>
        </div>
        <div class="input-group">
          <label for="password">Password</label>
          <input type="password" id="password" name="password" placeholder="Enter your password" required>
        </div>
        <button type="submit" class="btn">Log In</button>
        <p class="form-link">Don't have an account? <a href="#">Sign Up</a></p>
      </form>
    </div>
  </div>

  <!-- Recent Posts Section -->
  <section class="manga-posts" id="mangaPosts">
    <h2>Recent Manga Posts</h2>
    <p class="no-posts">No posts yet. Be the first to share your story!</p>
  </section>

  <footer>
    <p>&copy; 2025 Manga Writing Hub. All Rights Reserved.</p>
  </footer>

  <script>
    // Theme toggle logic
    const themeToggle = document.getElementById('themeToggle');
    const body = document.body;

    function setTheme(theme) {
      if (theme === 'light') {
        body.classList.add('light');
      } else {
        body.classList.remove('light');
      }
      localStorage.setItem('theme', theme);
    }

    // On load, set theme from localStorage or system preference
    (function() {
      const saved = localStorage.getItem('theme');
      if (saved) {
        setTheme(saved);
      } else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches) {
        setTheme('light');
      }
    })();

    themeToggle.addEventListener('click', () => {
      if (body.classList.contains('light')) {
        setTheme('dark');
      } else {
        setTheme('light');
      }
    });

    // Character count for textarea
    const mangaContent = document.getElementById("mangaContent");
    const characterCount = document.getElementById("characterCount");
    mangaContent.addEventListener("input", () => {
      characterCount.textContent = `${mangaContent.value.length}/1000`;
      characterCount.classList.toggle('over', mangaContent.value.length > 1000);
    });

    // Save script to localStorage
    document.getElementById("save-script").addEventListener("click", () => {
      const script = document.getElementById("editor").innerHTML;
      localStorage.setItem("mangaScript", script);
      const status = document.getElementById("save-status");
      status.textContent = "Script saved!";
      setTimeout(() => status.textContent = "", 2000);
    });

    // Load script from localStorage
    window.addEventListener("DOMContentLoaded", () => {
      const savedScript = localStorage.getItem("mangaScript");
      if (savedScript) document.getElementById("editor").innerHTML = savedScript;
    });

    // Cover preview
    document.getElementById("cover-upload").addEventListener("change", (event) => {
      const file = event.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = () => {
          const preview = document.getElementById("cover-preview");
          preview.innerHTML = `<img src="${reader.result}" alt="Manga Cover">`;
        };
        reader.readAsDataURL(file);
      }
    });

    // Sample feed data
    const sampleFeed = [
      { title: "Adventure in Space", script: "A thrilling journey beyond the stars..." },
      { title: "The Ninja Chronicles", script: "Discover the secret life of a ninja warrior." }
    ];
    // Populate the feed
    const feedContainer = document.getElementById("feed");
    sampleFeed.forEach((story) => {
      const storyDiv = document.createElement("div");
      storyDiv.classList.add("story");
      storyDiv.innerHTML = `<h3>${story.title}</h3><p>${story.script}</p>`;
      feedContainer.appendChild(storyDiv);
    });

    // Handle Manga Post Form
    const mangaForm = document.getElementById("mangaForm");
    const mangaPosts = document.getElementById("mangaPosts");
    const noPosts = mangaPosts.querySelector('.no-posts');
    let posts = [];

    mangaForm.addEventListener("submit", function(e) {
      e.preventDefault();
      const title = document.getElementById("mangaTitle").value.trim();
      const content = document.getElementById("mangaContent").value.trim();
      if (!title || !content) return;
      const post = { title, content, date: new Date().toLocaleString() };
      posts.unshift(post);
      updatePosts();
      mangaForm.reset();
      characterCount.textContent = "0/1000";
    });

    function updatePosts() {
      // Remove "no posts" message
      noPosts.style.display = posts.length ? "none" : "block";
      // Remove old posts
      mangaPosts.querySelectorAll('.post').forEach(el => el.remove());
      // Add new posts
      posts.forEach(post => {
        const div = document.createElement('div');
        div.className = 'post';
        div.innerHTML = `<h3>${post.title}</h3>
          <p>${post.content}</p>
          <div style="color:var(--muted);font-size:0.9em;margin-top:6px;">${post.date}</div>`;
        mangaPosts.appendChild(div);
      });
    }

    // Animated placeholder for editor
    editor.addEventListener("focus", function() {
      if (editor.innerText.trim() === "Start scripting your manga...") {
        editor.innerHTML = "";
      }
    });
    editor.addEventListener("blur", function() {
      if (editor.innerText.trim() === "") {
        editor.innerHTML = "Start scripting your manga...";
      }
    });
    if (editor.innerText.trim() === "") {
      editor.innerHTML = "Start scripting your manga...";
    }

    // Login form (demo only)
    document.getElementById("loginForm").addEventListener("submit", function(e) {
      e.preventDefault();
      alert("Demo: Log in functionality is not implemented. (Integrate Firebase/Auth as needed.)");
    });
  </script>
</body>
</html>